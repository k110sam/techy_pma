<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="org.sam.projectmanager.techy_pma.controllers.ProjectDetailsController"
            stylesheets="@../css/dashboard.css"
            prefWidth="1100.0" prefHeight="700.0">

    <!-- SIDEBAR -->
    <left>
        <VBox styleClass="sidebar" prefWidth="260.0" spacing="0">
            <VBox styleClass="sidebar-brand" spacing="4">
                <Label text="⬡ TECHY" styleClass="brand-logo"/>
                <Label text="PROJECT MANAGER" styleClass="brand-sub"/>
            </VBox>
            <VBox styleClass="user-profile-block" spacing="6">
                <HBox spacing="12" alignment="CENTER_LEFT">
                    <StackPane styleClass="avatar-circle">
                        <Label fx:id="avatarLabel" text="J" styleClass="avatar-letter"/>
                    </StackPane>
                    <VBox spacing="2">
                        <Label fx:id="sidebarUsername" text="username" styleClass="profile-name"/>
                        <Label fx:id="sidebarEmail" text="email" styleClass="profile-email"/>
                    </VBox>
                </HBox>
            </VBox>
            <Separator styleClass="sidebar-divider"/>
            <VBox styleClass="nav-section" spacing="4" VBox.vgrow="ALWAYS">
                <Label text="NAVIGATION" styleClass="nav-section-label"/>
                <Button text="  ⊞  Dashboard" onAction="#handleNavDashboard"
                        styleClass="nav-button" maxWidth="Infinity"/>
                <Button text="  ◈  My Projects" onAction="#handleNavMyProjects"
                        styleClass="nav-button" maxWidth="Infinity"/>
                <Button text="  ⊕  Browse Projects" onAction="#handleNavBrowse"
                        styleClass="nav-button" maxWidth="Infinity"/>
                <Button text="  ✦  Create Project" onAction="#handleCreateProject"
                        styleClass="nav-button, nav-create" maxWidth="Infinity"/>
            </VBox>
            <VBox styleClass="sidebar-footer" spacing="8">
                <Separator styleClass="sidebar-divider"/>
                <Button text="  ⊗  Logout" onAction="#handleLogout"
                        styleClass="nav-button, nav-logout" maxWidth="Infinity"/>
            </VBox>
        </VBox>
    </left>

    <!-- MAIN CONTENT -->
    <center>
        <VBox styleClass="main-content" spacing="0">

            <!-- Top Bar -->
            <HBox styleClass="topbar" alignment="CENTER_LEFT" spacing="16">
                <VBox spacing="2" HBox.hgrow="ALWAYS">
                    <Label fx:id="projectTitleLabel" text="Project Details" styleClass="topbar-title"/>
                    <Label fx:id="projectSubLabel" text="View project information and members" styleClass="topbar-sub"/>
                </VBox>
                <Button text="← Back" onAction="#handleNavBrowse"
                        styleClass="action-button, action-tertiary"/>
            </HBox>

            <!-- Content -->
            <ScrollPane fitToWidth="true" styleClass="content-scroll" VBox.vgrow="ALWAYS">
                <VBox spacing="20" styleClass="content-inner">

                    <!-- Project Info Card -->
                    <VBox styleClass="detail-card" spacing="20">

                        <!-- Header Row -->
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                <Label fx:id="projectNameLabel" text="Project Name"
                                       styleClass="project-name"
                                       style="-fx-font-size: 22px;"/>
                                <Label fx:id="ownerLabel" text="Owner: -" styleClass="project-owner"/>
                            </VBox>
                            <Label fx:id="statusBadgeLabel" text="STATUS" styleClass="badge, badge-not-started"/>
                            <Label fx:id="roleBadgeLabel" text="ROLE" styleClass="role-badge"/>
                        </HBox>

                        <Separator/>

                        <!-- Info Grid -->
                        <GridPane hgap="40" vgap="16">
                            <VBox spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                <Label text="DESCRIPTION" styleClass="detail-label"/>
                                <Label fx:id="descriptionLabel" text="-"
                                       styleClass="detail-value" wrapText="true"/>
                            </VBox>
                            <VBox spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <Label text="CREATED" styleClass="detail-label"/>
                                <Label fx:id="createdAtLabel" text="-" styleClass="detail-value"/>
                            </VBox>
                        </GridPane>

                        <!-- Progress Section -->
                        <VBox spacing="10">
                            <HBox alignment="CENTER_LEFT">
                                <Label text="PROGRESS" styleClass="detail-label" HBox.hgrow="ALWAYS"/>
                                <Label fx:id="progressPercentLabel" text="0%" styleClass="detail-label"/>
                            </HBox>
                            <ProgressBar fx:id="detailProgressBar" progress="0"
                                         maxWidth="Infinity" prefHeight="10"
                                         styleClass="project-progress-bar"/>
                        </VBox>

                        <!-- Owner Controls (Update progress/status) -->
                        <VBox fx:id="ownerControls" spacing="12" visible="false" managed="false">
                            <Separator/>
                            <Label text="OWNER CONTROLS" styleClass="section-title"/>
                            <HBox spacing="12" alignment="CENTER_LEFT">

                                <!-- Update Progress -->
                                <VBox spacing="6" HBox.hgrow="ALWAYS">
                                    <Label text="Update Progress:" styleClass="form-label"/>
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Slider fx:id="updateProgressSlider" min="0" max="100"
                                                styleClass="form-slider" HBox.hgrow="ALWAYS"/>
                                        <Label fx:id="updateProgressLabel" text="0%"
                                               styleClass="project-progress-text" prefWidth="40"/>
                                        <Button text="Update" onAction="#handleUpdateProgress"
                                                styleClass="action-button, action-primary"
                                                prefWidth="90"/>
                                    </HBox>
                                </VBox>

                                <!-- Update Status -->
                                <VBox spacing="6">
                                    <Label text="Update Status:" styleClass="form-label"/>
                                    <HBox spacing="10">
                                        <ComboBox fx:id="updateStatusComboBox"
                                                  styleClass="filter-combo" prefWidth="140"/>
                                        <Button text="Update" onAction="#handleUpdateStatus"
                                                styleClass="action-button, action-secondary"
                                                prefWidth="90"/>
                                    </HBox>
                                </VBox>

                            </HBox>
                        </VBox>

                        <!-- Member Controls (Leave project) -->
                        <HBox fx:id="memberControls" visible="false" managed="false"
                              alignment="CENTER_RIGHT">
                            <Button text="⊗ Leave Project" onAction="#handleLeaveProject"
                                    styleClass="action-button"
                                    style="-fx-background-color: #ffebee; -fx-text-fill: #c62828;"/>
                        </HBox>

                    </VBox>

                    <!-- Members Card -->
                    <VBox styleClass="detail-card" spacing="16">
                        <HBox alignment="CENTER_LEFT">
                            <Label text="PROJECT MEMBERS" styleClass="section-title" HBox.hgrow="ALWAYS"/>
                            <Label fx:id="memberCountLabel" text="0 members" styleClass="section-count"/>
                        </HBox>
                        <VBox fx:id="membersContainer" spacing="10"/>
                    </VBox>

                </VBox>
            </ScrollPane>

        </VBox>
    </center>

</BorderPane>